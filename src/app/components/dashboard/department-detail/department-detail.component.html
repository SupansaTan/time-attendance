<main>
  <div class="card rounded-25 border-0 shadow-lg">
    <div class="mt-4 mx-4">
      <h3 class="mb-0 heading d-inline">Department</h3>
      <h3 class="name d-inline px-3 ms-4 rounded-25 shadow text-white bg-blue">{{ department.name }}</h3>
    </div>

    <div class="row mx-3 mt-2 mb-3 g-3">
      <div class="col-2">
        <div class="chart-wrapper w-75">
          <svg viewBox="0 0 36 36" class="circular-chart green">
            <path class="circle-bg"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <path *ngIf="department.active_employee > 0" class="circle"
              [attr.stroke-dasharray]="getPercentage(department.active_employee, department.total_employee) + ', 100'"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <text x="18" y="19.35" class="percentage">{{ getPercentage(department.active_employee, department.total_employee) + '%' }}</text>
            <text x="10" y="25.35" class="total-employee">{{ department.active_employee + '/' + department.total_employee + ' คน' }}</text>
          </svg>
        </div>
      </div>

      <div class="col align-self-center m-0 detail-wrapper">
        <div class="row my-3 d-flex align-items-center date-wrapper">
          <i class="col-auto fas fa-calendar text-blue"></i>
          <p class="col-auto mb-0 px-3 rounded-25 shadow text-white bg-blue">{{ date }}</p>
        </div>

        <div class="row my-3 d-flex align-items-center">
          <i class="fas fa-clock me-2 col-auto"></i>
          <p class="px-2 rounded-25 shadow bg-white col-auto mb-0">{{ today_planshifts[0].start_time + ' - ' + today_planshifts[0].end_time }}</p>
        </div>

        <div class="row my-3 ot-wrapper d-flex align-items-center">
          <p class="fw-bold mb-0 col-auto">OT Plan</p>
          <p class="hours rounded-25 shadow bg-white mb-0 px-2 col-auto">{{ today_planshifts[0].overtime + " hours" }}</p>
        </div>
      </div>

    </div>
  </div>

  <div class="card rounded-25 border-0 shadow-lg mt-3">
    <h3 class="mt-4 mx-4 heading">Time Record</h3>

    <div class="table-responsive mx-4">
      <table class="table table-hover table-borderless">
        <thead class="text-white">
          <tr>
            <th scope="col">#</th>
            <th scope="col" class="text-center">Name</th>
            <th scope="col" class="text-center">Start Time</th>
            <th scope="col" class="text-center">End Time</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let plan of today_planshifts | slice: (page-1) * pageSize : page * pageSize" [class]="findTimeRecord(plan.employee[0].id).status? 'green':'grey'">
            <th scope="row">{{ today_planshifts.indexOf(plan)+1 }}</th>
            <th class="text-center">{{ plan.employee[0].first_name + ' ' + plan.employee[0].last_name }}</th>
            <th class="text-center">{{ in_record.status? in_record.time.slice(0,8) : '-' }}</th>
            <th class="text-center">{{ out_record.status? out_record.time.slice(0,8) : '-' }}</th>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="row mx-4 my-2 align-items-center">
      <ng-select [items]="table_option" bindLabel="value" bindValue="value" class="custom d-flex justify-content-start align-items-center col-1 rounded-50 pb-0"
        name="pageSize" [(ngModel)]="pageSize" [searchable]="false" [clearable]="false">
      </ng-select>
      <p class="d-flex align-items-center col-auto m-0">
        {{ 'Showing '+ (pageSize*(page-1)+1) +' to '+ (pageSize*page>today_planshifts.length? today_planshifts.length:pageSize*page) +' of '+ today_planshifts.length +' results'}}
      </p>
      <ngb-pagination class="d-flex justify-content-end col align-items-center" [pageSize]="pageSize" [(page)]="page"
        [collectionSize]="today_planshifts.length">
      </ngb-pagination>
    </div>
  </div>
</main>
