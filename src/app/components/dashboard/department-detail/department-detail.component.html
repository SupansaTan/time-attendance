<main>
  <div class="card rounded-25 border-0 shadow-lg">
    <div class="mt-4 mx-4">
      <h3 class="mb-0 heading d-inline">Department</h3>
      <h3 class="name d-inline px-3 ms-4 rounded-25 shadow text-white bg-blue">{{ department.name }}</h3>
    </div>

    <div class="row mx-3 mt-2 mb-3 g-3">
      <div class="col-2">
        <div class="chart-wrapper w-75">
          <svg viewBox="0 0 36 36" class="circular-chart green">
            <path class="circle-bg"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <path *ngIf="department.actual_emp > 0" class="circle"
              [attr.stroke-dasharray]="getPercentage(department.actual_emp, department.total_emp) + ', 100'"
              d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"
            />
            <text x="18" y="19.35" class="percentage">{{ getPercentage(department.actual_emp, department.total_emp) + '%' }}</text>
            <text x="10" y="25.35" class="total-employee">{{ department.actual_emp + '/' + department.total_emp + ' คน' }}</text>
          </svg>
        </div>
      </div>

      <div class="col align-self-center m-0 detail-wrapper">
        <div class="row my-3 d-flex align-items-center date-wrapper">
          <i class="col-auto fas fa-calendar text-blue"></i>
          <p class="col-auto mb-0 px-3 rounded-25 shadow text-white bg-blue">{{ date }}</p>
        </div>

        <div class="row my-3 d-flex align-items-center">
          <i class="fas fa-clock me-2 col-auto"></i>
          <p class="px-2 rounded-25 shadow bg-white col-auto mb-0">{{ department.start_time + ' - ' + department.end_time }}</p>
        </div>

        <div class="row my-3 ot-wrapper d-flex align-items-center">
          <p class="fw-bold mb-0 col-auto">OT Plan</p>
          <p class="hours rounded-25 shadow bg-white mb-0 px-2 col-auto">{{ department.ot_plan + " hours" }}</p>
        </div>
      </div>

    </div>
  </div>

  <div class="card rounded-25 border-0 shadow-lg mt-3">
    <h3 class="mt-4 mx-4 heading">Time Record</h3>

    <div class="table-responsive mx-4">
      <table class="table table-hover table-borderless">
        <thead class="text-white">
          <tr>
            <th scope="col">#</th>
            <th scope="col" class="text-center">Name</th>
            <th scope="col" class="text-center">Start Time</th>
            <th scope="col" class="text-center">End Time</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let employee of employees | slice: (page-1) * pageSize : page * pageSize" [class]="employee.start? 'green':'grey'">
            <th scope="row">{{ employees.indexOf(employee)+1 }}</th>
            <th class="text-center">{{ employee.name }}</th>
            <th class="text-center">{{ employee.start? employee.start : '-' }}</th>
            <th class="text-center">{{ employee.end? employee.end : '-' }}</th>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="row mx-4 my-2 align-items-center">
      <ng-select [items]="table_option" bindLabel="value" bindValue="value" class="custom d-flex justify-content-start align-items-center col-1 rounded-50 pb-0"
        name="pageSize" [(ngModel)]="pageSize" [searchable]="false" [clearable]="false">
      </ng-select>
      <p class="d-flex align-items-center col-auto m-0">
        {{ 'Showing '+ (pageSize*(page-1)+1) +' to '+ (pageSize*page>employees.length? employees.length:pageSize*page) +' of '+ employees.length +' results'}}
      </p>
      <ngb-pagination class="d-flex justify-content-end col align-items-center" [pageSize]="pageSize" [(page)]="page"
        [collectionSize]="employees.length">
      </ngb-pagination>
    </div>
  </div>
</main>
